<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TodoWeb</title>
    <base href="/" />
    <link href="css/app.css" rel="stylesheet" />
</head>
<body>
    <div id="app">
        <div style="padding: 50px; text-align: center; font-family: Arial;">
            <h1> ƒêang t·∫£i TodoWeb...</h1>
            <p>Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
            <div id="loading-status">Kh·ªüi t·∫°o ·ª©ng d·ª•ng</div>
        </div>
    </div>

    <div id="blazor-error-ui" style="display: none;">
        <div style="background: red; color: white; padding: 10px; position: fixed; bottom: 0; width: 100%;">
            ƒê√£ x·∫£y ra l·ªói.
            <a href="" class="reload" style="color: white; text-decoration: underline;">T·∫£i l·∫°i trang</a>
            <a class="dismiss" style="color: white; margin-left: 20px; cursor: pointer;">üóô</a>
        </div>
    </div>

    <script src="_framework/blazor.webassembly.js"></script>

    <script>
        // Hi·ªÉn th·ªã tr·∫°ng th√°i loading
        let status = document.getElementById('loading-status');
        let steps = [
            'ƒêang kh·ªüi t·∫°o ·ª©ng d·ª•ng...',
        ];

        let currentStep = 0;
        let interval = setInterval(() => {
            if (currentStep < steps.length) {
                status.textContent = steps[currentStep];
                currentStep++;
            } else {
                clearInterval(interval);
            }
        }, 2000);

        // B·∫Øt l·ªói Blazor
        window.Blazor = window.Blazor || {};
        window.Blazor.start = window.Blazor.start || function () {
            console.log('Blazor is starting...');
        };

        // Function ƒë·ªÉ refresh notifications t·ª´ Blazor
        window.refreshNotifications = function () {
            // This will be called from Blazor to refresh notifications
            console.log("Refresh notifications triggered");

            // C√≥ th·ªÉ th√™m logic ƒë·ªÉ trigger refresh n·∫øu c·∫ßn
            if (window.blazorRefreshers && window.blazorRefreshers.notifications) {
                window.blazorRefreshers.notifications.forEach(callback => {
                    try {
                        callback();
                    } catch (e) {
                        console.error('Error in notification refresh callback:', e);
                    }
                });
            }
        };

        // Helper ƒë·ªÉ Blazor ƒëƒÉng k√Ω refresh callbacks
        window.registerBlazorRefresh = function (type, callback) {
            if (!window.blazorRefreshers) {
                window.blazorRefreshers = {};
            }
            if (!window.blazorRefreshers[type]) {
                window.blazorRefreshers[type] = [];
            }
            window.blazorRefreshers[type].push(callback);
            console.log(`Registered ${type} refresh callback`);
        };

        // X·ª≠ l√Ω l·ªói to√†n c·ª•c
        window.addEventListener('error', function (e) {
            console.error('Global error:', e.error);
        });

        // X·ª≠ l√Ω promise rejections
        window.addEventListener('unhandledrejection', function (e) {
            console.error('Unhandled promise rejection:', e.reason);
        });
    </script>
</body>
</html>